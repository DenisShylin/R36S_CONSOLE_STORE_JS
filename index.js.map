{"version":3,"file":"index.js","sources":["../src/js/hero.js","../src/main.js"],"sourcesContent":["/**\n * @fileoverview Hero section initialization module\n * @description Contains functions for hero section setup, image management,\n * responsiveness, and event handlers for buttons.\n */\n\n/**\n * Initializes the Hero section on the page.\n * Sets up images, handles load events, configures responsiveness and animations.\n * @returns {void}\n */\nexport function initHero() {\n  console.log('Hero section initialized');\n\n  // DOM elements\n  const heroSection = document.querySelector('.hero');\n  const heroImage = document.querySelector('.hero__console-img');\n  const heroContent = document.querySelector('.hero__content');\n  const desktopDescription = document.querySelector(\n    '.hero__description--desktop'\n  );\n  const mobileDescription = document.querySelector(\n    '.hero__description--mobile'\n  );\n  const heroPricing = document.querySelector('.hero__pricing');\n  const buyButton = document.getElementById('buy-button');\n  const moreDetailsButton = document.getElementById('more-details-button');\n\n  // Хранение ссылок на обсерверы для корректного удаления\n  let contentObserver = null;\n\n  /**\n   * Sets up hero section images.\n   * Establishes event handlers for the main image.\n   * @private\n   */\n  function setupHeroImage() {\n    if (!heroImage) {\n      console.error('Hero image element not found');\n      return;\n    }\n\n    console.log('Setting up hero image');\n\n    // Event handlers\n    heroImage.onerror = () => {\n      console.error('Failed to load hero image:', heroImage.src);\n\n      try {\n        // Получаем первый элемент из srcset как запасной вариант\n        const srcsetParts = heroImage.getAttribute('srcset');\n        if (srcsetParts) {\n          const parts = srcsetParts.split(',');\n          if (parts && parts.length > 0) {\n            const fallbackSrc = parts[0].split(' ')[0]; // Берем первый источник из srcset\n            console.log('Using fallback image:', fallbackSrc);\n            heroImage.src = fallbackSrc;\n          }\n        }\n      } catch (error) {\n        console.error('Error setting fallback image:', error);\n      }\n\n      heroSection?.classList.add('hero--loaded'); // Still show the section\n    };\n\n    heroImage.onload = () => {\n      console.log('Hero image loaded successfully');\n      heroSection?.classList.add('hero--loaded');\n    };\n\n    // Add decoding attribute for better performance\n    heroImage.decoding = 'async';\n\n    // If the image is already loaded (from cache)\n    if (heroImage.complete) {\n      console.log('Hero image already loaded (from cache)');\n      heroSection?.classList.add('hero--loaded');\n    }\n  }\n\n  /**\n   * Adapts content for different screen sizes.\n   * Toggles between mobile and desktop versions of the description.\n   * @private\n   */\n  function adjustForViewport() {\n    const isDesktop = window.innerWidth > 992;\n\n    if (desktopDescription && mobileDescription && heroPricing) {\n      if (isDesktop) {\n        desktopDescription.style.display = 'block';\n        mobileDescription.style.display = 'none';\n      } else {\n        desktopDescription.style.display = 'none';\n        mobileDescription.style.display = 'block';\n      }\n    }\n  }\n\n  /**\n   * Sets up content appearance animation on scroll.\n   * Uses IntersectionObserver to determine element visibility.\n   * @private\n   */\n  function setupContentAnimation() {\n    if (!heroContent) return;\n\n    // Удаляем предыдущий observer если он существует\n    if (contentObserver) {\n      contentObserver.disconnect();\n    }\n\n    contentObserver = new IntersectionObserver(\n      entries => {\n        entries.forEach(entry => {\n          if (entry.isIntersecting) {\n            entry.target.classList.add('animate-in');\n            // Отключаем наблюдение после анимации\n            contentObserver.unobserve(entry.target);\n          }\n        });\n      },\n      { threshold: 0.1 }\n    );\n\n    contentObserver.observe(heroContent);\n  }\n\n  /**\n   * Sets up event handlers for section buttons.\n   * @private\n   */\n  function setupButtonHandlers() {\n    // Handler for buy button\n    if (buyButton) {\n      // Удаляем предыдущие обработчики, чтобы избежать дублирования\n      buyButton.removeEventListener('click', handleBuyButtonClick);\n      buyButton.addEventListener('click', handleBuyButtonClick);\n    }\n\n    // Handler for \"More details\" button\n    if (moreDetailsButton) {\n      // Удаляем предыдущие обработчики, чтобы избежать дублирования\n      moreDetailsButton.removeEventListener('click', handleMoreDetailsClick);\n      moreDetailsButton.addEventListener('click', handleMoreDetailsClick);\n    }\n  }\n\n  /**\n   * Обработчик клика по кнопке Buy\n   * @private\n   */\n  function handleBuyButtonClick() {\n    try {\n      // Open product link in new tab\n      window.open(\n        'https://www.aliexpress.com/item/1005007171465465.html',\n        '_blank',\n        'noopener,noreferrer'\n      );\n    } catch (error) {\n      console.error('Error opening product link:', error);\n    }\n  }\n\n  /**\n   * Handles click on \"More details\" button.\n   * Performs smooth scrolling to features section.\n   * @param {Event} e - Click event\n   * @private\n   */\n  function handleMoreDetailsClick(e) {\n    e.preventDefault();\n    const featuresSection = document.getElementById('features');\n    const header = document.querySelector('.header');\n\n    if (featuresSection && header) {\n      try {\n        // Account for fixed header height when scrolling\n        const headerHeight = header.offsetHeight;\n        const elementPosition = featuresSection.getBoundingClientRect().top;\n        const currentScrollY = window.scrollY || window.pageYOffset;\n        const offsetPosition = elementPosition + currentScrollY - headerHeight;\n\n        // Smooth scroll to features section\n        window.scrollTo({\n          top: offsetPosition,\n          behavior: 'smooth',\n        });\n\n        // Update URL without page reload\n        window.history.replaceState(\n          null,\n          '',\n          `${window.location.pathname}#features`\n        );\n      } catch (error) {\n        console.error('Error scrolling to features:', error);\n\n        // Запасной вариант - обычный переход по якорю\n        window.location.hash = 'features';\n      }\n    }\n  }\n\n  /**\n   * Функция очистки слушателей и наблюдателей\n   * @private\n   */\n  function cleanup() {\n    // Отключаем IntersectionObserver\n    if (contentObserver) {\n      contentObserver.disconnect();\n      contentObserver = null;\n    }\n\n    // Удаляем слушатель событий resize\n    window.removeEventListener('resize', adjustForViewport);\n\n    // Удаляем обработчики кнопок\n    if (buyButton) {\n      buyButton.removeEventListener('click', handleBuyButtonClick);\n    }\n\n    if (moreDetailsButton) {\n      moreDetailsButton.removeEventListener('click', handleMoreDetailsClick);\n    }\n  }\n\n  // Component initialization\n  setupHeroImage();\n  adjustForViewport();\n  setupContentAnimation();\n  setupButtonHandlers();\n\n  // Listen for window resize event\n  window.removeEventListener('resize', adjustForViewport); // Удаляем предыдущие\n  window.addEventListener('resize', adjustForViewport);\n\n  // Добавляем обработчик для очистки при уничтожении секции\n  if (typeof window !== 'undefined') {\n    window.addEventListener('unload', cleanup);\n  }\n\n  // Возвращаем функцию очистки\n  return cleanup;\n}\n","// main.js - Точка входа в приложение\n// Импорт всех стилей\nimport './css/styles.css';\nimport './css/hero.css';\n// Другие стили при необходимости\n\n// Импорт компонентов\nimport { initHero } from './js/hero.js';\n// Другие компоненты при необходимости\n\nconsole.log('Main.js инициализирован');\n\n// Вспомогательная функция для определения поддержки браузером\nfunction checkBrowserCompatibility() {\n  // Проверка поддержки IntersectionObserver (для анимаций при скролле)\n  const hasIntersectionObserver = 'IntersectionObserver' in window;\n  // Проверка поддержки Flexbox\n  const hasFlexbox = (function () {\n    const el = document.createElement('div');\n    el.style.display = 'flex';\n    return el.style.display === 'flex';\n  })();\n  // Проверка поддержки CSS Grid\n  const hasGrid = (function () {\n    const el = document.createElement('div');\n    el.style.display = 'grid';\n    return el.style.display === 'grid';\n  })();\n  // Логирование результатов проверок\n  console.log('Поддержка браузера:');\n  console.log('- IntersectionObserver:', hasIntersectionObserver);\n  console.log('- Flexbox:', hasFlexbox);\n  console.log('- CSS Grid:', hasGrid);\n  // Добавление классов к body для условного стилизования\n  if (!hasIntersectionObserver)\n    document.body.classList.add('no-intersection-observer');\n  if (!hasFlexbox) document.body.classList.add('no-flexbox');\n  if (!hasGrid) document.body.classList.add('no-grid');\n  return {\n    hasIntersectionObserver,\n    hasFlexbox,\n    hasGrid,\n  };\n}\n\n// Инициализация страницы после загрузки DOM\ndocument.addEventListener('DOMContentLoaded', () => {\n  console.log('DOM загружен');\n\n  // Проверка совместимости браузера\n  const compatibility = checkBrowserCompatibility();\n\n  // Инициализация компонентов\n  initHero();\n\n  // Добавим информацию о загрузке страницы в консоль для отладки\n  const loadTime = performance.now();\n  console.log(`Страница загружена за ${loadTime.toFixed(2)}ms`);\n\n  // Регистрация сервис-воркера для офлайн-функциональности (если нужно)\n  if ('serviceWorker' in navigator && import.meta.env.PROD) {\n    window.addEventListener('load', () => {\n      // Правильный базовый путь для GitHub Pages\n      const base = import.meta.env.DEV ? '/' : '/R36S_CONSOLE_STORE_JS/';\n      navigator.serviceWorker\n        .register(`${base}service-worker.js`)\n        .then(registration => {\n          console.log('ServiceWorker зарегистрирован:', registration);\n        })\n        .catch(error => {\n          console.error('Ошибка регистрации ServiceWorker:', error);\n        });\n    });\n  }\n});\n\n// Обработка ошибок на уровне window\nwindow.onerror = function (message, source, lineno, colno, error) {\n  console.error('Глобальная ошибка:', {\n    message,\n    source,\n    lineno,\n    colno,\n    error,\n  });\n  return false; // Пусть браузер также показывает ошибки в консоли\n};\n\n// Экспорт версии приложения для отладки\nwindow.appVersion = {\n  version: '1.0.0',\n  buildDate: new Date().toISOString(),\n  environment: import.meta.env.MODE,\n  basePath: import.meta.env.DEV ? '/' : '/R36S_CONSOLE_STORE_JS/',\n};\n\nconsole.log('Main.js выполнение завершено');\n"],"names":["initHero","heroSection","heroImage","heroContent","desktopDescription","mobileDescription","heroPricing","buyButton","moreDetailsButton","contentObserver","setupHeroImage","srcsetParts","parts","fallbackSrc","error","adjustForViewport","isDesktop","setupContentAnimation","entries","entry","setupButtonHandlers","handleBuyButtonClick","handleMoreDetailsClick","e","featuresSection","header","headerHeight","elementPosition","currentScrollY","offsetPosition","cleanup","checkBrowserCompatibility","hasIntersectionObserver","hasFlexbox","el","hasGrid","loadTime","registration","message","source","lineno","colno"],"mappings":"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"}